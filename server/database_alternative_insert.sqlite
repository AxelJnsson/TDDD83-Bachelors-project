DROP TABLE IF EXISTS used_product;
DROP TABLE IF EXISTS new_product;

CREATE TABLE  used_product (
    product_id INTEGER PRIMARY KEY,
    user_id INTEGER, 
    FOREIGN KEY(product_id) REFERENCES product(product_id),
    FOREIGN KEY(user_id) REFERENCES user(user_id)
);

CREATE TABLE new_product (
  product_id INTEGER PRIMARY KEY,
FOREIGN KEY(product_id) REFERENCES product(product_id)
);

INSERT INTO new_product(product_id, brand, model, name, price, color, year, type)
SELECT product_id, brand, model, name, price, color, year, type
FROM product
WHERE new_or_not = '1';

INSERT INTO used_product(product_id, brand, model, name, price, color, year, type, user_id, email, first_name, last_name)
SELECT A.product_id, A.brand, A.model, A.name, A.price, A.color, A.year, A.type, B.user_id, B.email, B.first_name, B.last_name
FROM product A, user B
WHERE B.user_id = A.seller AND B.user_id IN (SELECT seller
                                             FROM product
                                             WHERE new_or_not = '0');